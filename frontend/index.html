<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Panel</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container">
      <a class="navbar-brand" href="/index.html">Admin Panel</a>
      <div class="collapse navbar-collapse">
        <ul class="navbar-nav ms-auto" id="navLinks">
          <!-- Links will be injected by JS -->
        </ul>
      </div>
    </div>
  </nav>
  <div class="container mt-5">
    <div class="row justify-content-center">
      <div class="col-md-8 text-center">
        <h1 class="display-4 mb-3">Welcome to the Admin Panel</h1>
        <p class="lead mb-4">Manage your admin account, view and edit your profile, and access admin features. Please register or log in to continue.</p>
        <div id="mainActions">
          <!-- Buttons will be injected by JS -->
        </div>
      </div>
    </div>
  </div>
  <script>
    function renderNavAndActions() {
      const token = localStorage.getItem('token');
      const navLinks = document.getElementById('navLinks');
      const mainActions = document.getElementById('mainActions');
      if (token) {
        // Parse token to check if Super Admin
        let isSuperAdmin = false;
        try {
          const payload = JSON.parse(atob(token.split('.')[1]));
          isSuperAdmin = payload.adminType === 'Super Admin';
        } catch (e) {}
        navLinks.innerHTML = `
          <li class="nav-item"><a class="nav-link" href="/profile/view.html">Profile</a></li>
          <li class="nav-item"><a class="nav-link" href="#" id="logoutBtn">Logout</a></li>
        `;
        mainActions.innerHTML = `
          <a href="/profile/view.html" class="btn btn-success btn-lg me-2">View Profile</a>
          ${isSuperAdmin ? '<a href="/profile/superadmin.html" class="btn btn-warning btn-lg me-2">Requests</a>' : ''}
          <button class="btn btn-outline-danger btn-lg" id="logoutBtn2">Logout</button>
        `;
      } else {
        navLinks.innerHTML = `
          <li class="nav-item"><a class="nav-link" href="/auth/login.html">Login</a></li>
          <li class="nav-item"><a class="nav-link" href="/auth/register.html">Register</a></li>
        `;
        mainActions.innerHTML = `
          <a href="/auth/login.html" class="btn btn-primary btn-lg me-2">Login</a>
          <a href="/auth/register.html" class="btn btn-outline-primary btn-lg">Register</a>
        `;
      }
      // Logout functionality
      document.querySelectorAll('#logoutBtn, #logoutBtn2').forEach(btn => {
        btn && btn.addEventListener('click', function(e) {
          e.preventDefault();
          localStorage.removeItem('token');
          window.location.reload();
        });
      });
    }
    renderNavAndActions();
  </script>
</body>
</html>
